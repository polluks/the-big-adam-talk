* I. Overview

** Audience

- Those who have heard of Adam.
- Those who haven't heard of Adam.
- Those who want a comprehensive run-through.

** Commercials

- Stand-Alone Adam (is that Legal?)
- Expansion Module #3

** Why?

- [[https://i.ebayimg.com/images/g/PbkAAOSwx-9in4ST/s-l1200.webp][Market to Little Billy]]
- Do Homework, then games.
- [[https://books.google.com/books?id=NbgDAAAAMBAJ&printsec=frontcover&source=gbs_ge_summary_r&cad=0#v=onepage&q&f=false][$600 Target price (p. 75)]], OR
- $400 if you had a ColecoVision (EM#3)
- [[https://diroccovision.com/Coleco/adam/Pics/Hardware/Coleco%20ADAM%20Master%20Box%202412%20Internal%201.jpg][Including a printer IN THE BOX!]]
- Why "Tape?" [[https://archive.org/details/creativecomputing-1983-01/page/n243/mode/2up][Disk drives were EXPENSIVE!]]

** No. Why do this video?

- At most, 500,000 made, between 1983 and 1984.
- Bad repuation due to early production problems
- [[file:biggest-pc-duds.png][Lots of apocryphal bull****!]]
  
** What is the Coleco Adam?

- A computer
- With Data Storage
- And a Printer
- And a ColecoVision

- Stuffed in a box
  that makes train sets look small.
  
*** [[https://lowendbox.com/wp-content/uploads/2023/07/coleco-adam-closeup.png][The Box]]

- [[file:all-three-boxes.jpg][Freakin' Huge!]]
- [[https://scontent-dfw5-2.xx.fbcdn.net/v/t39.30808-6/393820530_6935719699843079_3443172399603887035_n.jpg?stp=cp6_dst-jpg&_nc_cat=102&ccb=1-7&_nc_sid=5f2048&_nc_ohc=SciXLdmpKxgAX__hajD&_nc_ht=scontent-dfw5-2.xx&oh=00_AfC_FA_3zDsvppyaReIC4zit4v4C89l08EdNv4wlaMfZ9Q&oe=653C2836][Seriously, it's huge.]]
- [[https://scontent-dfw5-1.xx.fbcdn.net/v/t39.30808-6/394650988_363729616084144_9166031926247311215_n.jpg?_nc_cat=103&ccb=1-7&_nc_sid=5f2048&_nc_ohc=7GAT1j6dx58AX9goYI7&_nc_ht=scontent-dfw5-1.xx&oh=00_AfBkf23gG5IOR_PAdVuZ6ENJCYrXwLKKiB9yZ7yURXVBtw&oe=653B217E][No, really.]]
- [[https://scontent-ord5-1.xx.fbcdn.net/v/t39.30808-6/394612157_284424064553154_8784033653621902596_n.jpg?_nc_cat=109&ccb=1-7&_nc_sid=5f2048&_nc_ohc=fFiLXFWpOjUAX_etzgv&_nc_ht=scontent-ord5-1.xx&oh=00_AfAoW4vC19VoZtQmOIbbqoIr9NKefMRdxPuM3B82srjFVQ&oe=653BDE51][I Hope you have Shelf Space.]]
- Memory console
- Printer and ephemera
- Manuals
- Switch Box
- SmartBASIC
- Buck Rogers: Planet of Zoom
- One Blank DDP
  
- [[https://content.invisioncic.com/r322239/gallery/album_932/gallery_34480_932_38891.jpg][Expansion Module #3]]
  
*** The Memory Console

Came in two varieties:

- [[https://content.invisioncic.com/r322239/monthly_07_2011/post-25956-0-70461600-1309666509.jpg][Stand-Alone]] ($700)
- [[http://dunfield.classiccmp.org/adam/h/e3.jpg][Expansion Module #3 for ColecoVision ($500)]]

*** Specs

- 64K of DRAM
- 16K of VDP DRAM (64+16 = 80K!)
- Z80 CPU @ 3.58MHz
- SN76489 Digital Complex Sound Generator (DCSG)
- Master 6801 CPU for AdamNet
- Slave 6801 CPU for DDP Drive
- (1) DDP Drive
- (2) Joystick Ports
- (2) AdamNet Ports
- (3) Internal Card Slots
- (1) External Expansion Bus
- (1) Printer/Power connector (also AdamNet)
- (1) Modulated RF output
- (1) AUX VIDEO (Composite) output
- (1) Complete ColecoVision (!)
- (1) EOS ROM (the Adam BIOS)
- (1) OS7 ROM (the ColecoVision BIOS)
- (1) SmartWriter ROM (Word Processor)
  
*** [[https://www.diroccovision.com/Coleco/adam/Pics/Cards/Slots/SLOT%203_1.gif][Expansion]]

**** AdamNet

- Two AdamNet ports
  One in front
  One on the left side
  (Actually, the printer connection too)

- [[https://i.ebayimg.com/images/g/674AAOSwiBZkixCq/s-l1200.jpg][Uses Standard 6P6C cross-wired cabling]]
- [[file:disk-drive-back.jpg][Peripherals are daisy chained]]
- [[https://i.ebayimg.com/images/g/THsAAOSw4NZbdTy-/s-l1600.jpg][Passive T-Adapters for more ports]]

- 62,500 bits per second
- One Wire for RX/TX

- Inverted; open-collector
  (the bus is high if all connected devices are high,
  and the bus is low if any device drives a zero.)

- Uses 6801's WAIT-for-break
  to implement a multi device network.

- [[file:disk-drive-front.jpg][Disk Drives]]
- VDE
- [[https://diroccovision.com/Coleco/adam/Expansion/FoxADE.jpg][ADE]]
- Printer

**** [[file:right-expansion.jpg][Right slot]]

- Exactly like ColecoVision Expansion slot
- [[https://i.ytimg.com/vi/aYywqZp-uBY/maxresdefault.jpg][Expansion #1 for Atari VCS (2600)]]
- [[https://thumbs.worthpoint.com/zoom/images3/1/0716/17/address-book-filer-auto-dialer-coleco_1_e6c852f8f9a143e8d6d3831ec60c6786.jpg][AutoDialer]]
- [[https://www.diroccovision.com/Coleco/adam/Pics/Cards/Other/Orphanware%2080%20Column%20Video.gif][OrphanWare 80 Column]]
- EVE SP-1
- etc...

**** Internal Slot 1

- Limited I/O
- Intended for AdamLink [[https://i.pinimg.com/736x/6c/48/c0/6c48c03e2950380ece9c468509343807--modem-instruments.jpg][MODEM]]
- [[https://diroccovision.com/Coleco/adam/Pics/Cards/MI/MI%20Dual%20Serial.gif][MI Dual Serial Interface]]
- [[https://diroccovision.com/Coleco/adam/Pics/Cards/MI/MI%20Powermate%20Host.jpg][MI and MicroFox IDE Hard Disk Adapters]]
  
**** Internal Slot 2

- More I/O, some memory mapping
- Originally intended for [[https://www.diroccovision.com/Coleco/adam/Pics/Cards/Coleco/French%20Card.jpg][Language Cards]]
- Now used for I/O and [[https://www.diroccovision.com/Coleco/adam/Pics/Cards/MicroFox/MF%20Memory.gif][memory addressors]]

**** Internal Slot 3

- Memory addressing, limited I/O
- Originally intended for [[https://www.diroccovision.com/Coleco/adam/Pics/Cards/Exp%20Collage.jpg][64K RAM Expansion]]
- Now used for larger memory cards, up to [[https://diroccovision.com/Coleco/adam/Pics/Cards/MicroFox/MF%201mb.gif][2MB]]

*** [[https://content.invisioncic.com/r322239/monthly_05_2016/post-44577-0-17162700-1462626598.jpg][Keyboard]]

- Keycaps in [[https://upload.wikimedia.org/wikipedia/commons/thumb/d/de/Handel_Gothic_Type_Specimen.svg/1920px-Handel_Gothic_Type_Specimen.svg.png][Handel Gothic]]
- Dome switches
- 78 keys
- 6 Function Keys (I-VI)
- Command Keys

- ESCAPE/WP
- WILD CARD
- UNDO
- MOVE/COPY
- STORE/GET
- CLEAR
- INSERT
- PRINT
- DELETE
  
- Arrow Keys and Home

*** [[https://i.ebayimg.com/images/g/QZMAAOSwzS5hnZuD/s-l1200.webp][SmartWriter Printer]]

- [[https://digibarn.com/collections/systems/coleco-adam/CIMG3309.JPG][The printer supplies THE POWER!]]
- Daisy Wheel printer
- [[https://diroccovision.com/Coleco/adam/Accessories/PICA.gif][Uses variant of Diablo wheels]]
- Most common wheel is Courier 72
- Others include Pica 10, Prestige Elite 12
- [[https://diroccovision.com/Coleco/adam/Accessories/ColecoVision%20ADAM%20Ribbon.jpg][Compatible with Diablo HyType I ribbons]]
- 80 columns
- 16 character print buffer
- 10 characters per second print speed

- Bi-Directional
  Underlining
  Faster printing

- Half-Line-Feeds
  For superscripts and subscripts
  
- Hollow platen (LOUD!)

* II. Demos

** Turning it on

*** SmartWriter (more later)

- If nothing to boot, goes into SmartWriter

*** Loading Buck Rogers

- Insert a data pack into either drive
- Pull the COMPUTER reset switch
- It will boot.

*** Loading Zaxxon

- Plug in a ColecoVision cartridge
- Pull the cartridge reset

** SmartWriter

*** Typewriter

- What you type, goes to printer
- A way to ease neophytes into the computer

*** Word Processor

- Press ESCAPE/WP for Word Processor.
- Any text typed in Typewriter migrates to Word Processor

- Margin/Tab/Etc
- Screen options
- Search/Replace
- Hi-Lite
- Hi-Lite Erase
- Super/Subscript

*** Store/Get

- Store and retrieve documents
- Works with both DDP and Disk
- Filenames up to 11 characters

*** Editing

- Get Announce
- Search and replace
- Store it.

*** Backup Files

- Last edit is backed up
- Backup File Dir

*** How many pages?

- 16 pages unexpanded
- 32 pages expanded

** Storage

*** [[file:ddp-in-case.jpg][DDPs]]

- block oriented
- PRE-FORMATTED

- Not User Formattable without help!
  e.g. [[https://diroccovision.com/Coleco/adam/Pics/Cards/Lundy/DD%20MEGACOPY%20REDUX.jpg][(Trisyd MegaCopy)]]

- 256 Kilobytes (256 blocks)
- 20ips search / 80ips read and write (V)
- DON'T LEAVE A TAPE IN DRIVE!

**** [[file:ddp-right.jpg][DDP Format: Right Directory]]

- GW format
- Block 0 at beginning of tape
- Used by Super Games

- Buck Rogers: Planet of Zoom
- Donkey Kong
- Donkey Kong Jr.
- Dragons Lair
- etc

 **** [[file:ddp-center.jpg][DDP Format: Center Directory]]

- HE Format (Howard Eglowstein)
- Block 0 in center of tape
- Faster directory block access
- Used by SmartBASIC and EOS tapes

**** DDPs versus Standard Tapes

- DDP: Thicker Lexan(tm) cassette shell
- DDP: Lubricated rollers in shell
- DDP: Tighter mechanical tolerances; smoother.
- DDP: Holes in different places

**** [[http://adamarchive.org/archive/Technical/ADAM%20Mods/Audio%20Cassette%20Tape%20to%20a%20ADAM%20DDP%20Pack%21%21%20v2.2.pdf][Adapting Standard Tapes]]

- Use 60 minute Type 1 tapes
- Drill alignment holes
  
- Three methods of formatting
  
--------------------------------------
+ Trisyd Megacopy
+ Dubbing using standard cassette deck
+ MAME castool wav to tape
--------------------------------------
  
**** Using mame castool

- Get MAME from http://mamedev.org/
- Run castool

#+begin_src sh
$ dd if=/dev/zero of=blank-center.ddp bs=1 count=262144
$ ./castool convert ddp blank-center.ddp blank-center.wav
#+end_src

- Use your favorite tool to record to tape

#+begin_src sh
$ audacity blank-center.wav
#+end_src

*** Floppy Disks

- Capacities from [[https://diroccovision.com/Coleco/adam/Pics/Expansion/525%20Disk%20Drive.jpg][160K]] to [[https://diroccovision.com/Coleco/adam/Pics/Expansion/MI%20Adam%20net%20Floppy.gif][1.44MB]]
- Definitely faster than DDP
- Attaches via [[file:disk-drive-back.jpg][AdamNet.]]

*** [[http://ann.hollowdreams.com/adamsupplies.html][Hard Disk]]

- Larger
- Much Faster than floppies or DDPs
- Connect via Internal card or AdamNet
- Handle CP/M or EOS volumes
- Quick demo using AdamEm

*** [[https://fujinet.online/wp-content/uploads/2022/03/ADAM-FujiNet-v1.0-CONFIG.jpg][Modern Solutions (ADE and FujiNet)]]

- Connect via AdamNet
- Uses SD cards
- Mount images in one of four device IDs
- Handles DDP, DSK, and ROMs
- FujiNet adds network storage and applications
- Quick boot of Buck Rogers over Internet

*** Comparison of capacities

- Adam thinks of media in 1024 byte blocks
- DDP drives have 256 blocks
- [[https://diroccovision.com/Coleco/adam/Pics/Expansion/525%20Disk%20Drive.jpg][Original Coleco drives have 160 blocks]]
- [[https://content.invisioncic.com/r322239/monthly_08_2017/post-10892-0-07950100-1503737482.jpg][Micro Innovations 5¼ Floppy Drive had 320 blocks]]
- [[https://content.invisioncic.com/r322239/monthly_08_2017/post-10892-0-27176300-1503737664.jpg][Micro Innovation 3½ Floppy Drive had 720 blocks]]
- Micro Innovation also did a 1.44MB 3½ drive. 1440 blocks

*** Filesystems

**** EOS

- Elementary
- In ROM
- Sequential
- Only Contiguous blocks
- FLAT FILESYSTEM
- Last file on tape assumed to have rest of tape capacity
- 12 Char Filenames
  - 11 Char name
  - 1 Char type
- Pre-allocated
- EOS 5 can do 4.3T volumes
- EOS 6 can do 64MB volumes

**** [[https://diroccovision.com/Coleco/adam/Library/Coleco/CPM/CPM%20%207832.jpg][CP/M]]

- CP/M Version 2.2
- Supports 160K Disk
- Supports 256K DDP
- Supports 64K RAM Disk
- Supports Printer
- Supports AdamNet Serial Interface
- Emulates VT-52 (H19) terminal
- Scrolling 80 column window
- Smart Key display
- Thousands of CP/M programs
- Includes transfer programs
- Includes backup utility
- Includes Formatter for disk/tape
- Includes Sysgen
- Includes Config
- Can be patched for other capacities

**** T-DOS

- CP/M Replacement
- By Tony Morehen and Guy Cousineau
- 40 column text mode
- 80 column virtual display
- Supports more disk capacities
- Supports Microfox IDE Hard Disk
- Supports directories
- Supports time-stamps
- Supports EVE 80 column expansion
- Supports MIB serial/parallel card

** SmartBASIC

- AppleSoft Compatible
- Emulates lo-res and hi-res graphics
- Loaded from Data Pack or disk
- Written by Randy Hyde/Lazer MicroSystems

*** Lo-Res Graphics

#+begin_src basic
10 GR
11 COLOR = INT(RND(1)*16)
12 PRINT "BOXES"
20 x1 = INT(RND(1)*39)
30 x2 = INT(RND(1)*39)
40 y1 = INT(RND(1)*39)
50 y2 = INT(RND(1)*39)
60 HLIN x1, x2 AT y1
70 HLIN x1, x2 AT y2
80 VLIN y1, y2 AT x1
90 VLIN y1, y2 AT x2
100 GOTO 11
#+end_src

*** Hi-Res Graphic

#+begin_src basic
100 HGR
101 PRINT "SINE WAVE HARMONIC PLOT"
110 HCOLOR = 1
120 a = 50
130 f = .0125
140 p = 0
150 FOR i = 0 TO 4
160 FOR x = 0 TO 255
170 y = a*SIN(2*3.14159*f*x+p)+100
180 HPLOT x, y
190 NEXT x
200 f = f*2: i = i+1
210 HCOLOR = i
220 NEXT i
#+end_src

*** Hi-Res color clash

- HGR uses VDP MODE 2 (BITMAP)
  
- Due to color attributes being 8x1 pixels,
  some color clash does occur.
  
#+begin_src basic
100 HGR
101 PRINT "MOIRE PATTERN"
102 C=1:S=3
110 HCOLOR=C
120 FOR x=0 to 255 STEP S:HPLOT 128,80 TO X,1:NEXT X
130 FOR y=0 to 159 STEP S:HPLOT 128,80 TO 255,Y:NEXT Y
140 FOR x=255 to 0 STEP -S:HPLOT 128,80 TO x,159:NEXT X
150 FOR y=159 to 0 STEP -S:HPLOT 128,80 TO 1,y:NEXT Y
160 C=C+1
170 GOTO 110
#+end_src

** [[https://diroccovision.com/Coleco/adam/Library/Coleco/LOGO/LOGO%207600%20(R).jpg][SmartLOGO]]

- Done by LCSI, who also did Apple2 and Atari versions
- 31 sprites
- sound

*** TO SQUARE

#+begin_src logo
TO SQUARE
    REPEAT 4 [ FD 100 RT 90 ]
END
#+end_src

*** TO STAR

#+begin_src logo
TO STAR
    REPEAT 30 [ SQUARE RT 12 ]
END
#+end_src

*** TO CIRCLE

#+begin_src logo
TO CIRCLE
   REPEAT 360 [ RT 1 FD 1 ]
END
#+end_src

** Productivity Apps

*** [[https://diroccovision.com/Coleco/adam/Library/Coleco/ADAMCalc/ADAMCALC%207831%20(R).jpg][AdamCalc]]

- Comparable with VisiCalc
- 255 Rows, 255 columns
- Easy to use

*** [[https://diroccovision.com/Coleco/adam/Library/Coleco/SmartFILER/SmartFiler%207813%20(R).jpg][SmartFiler]]

- Simple ISAM Database application
- Indexable Character and Number types
  Maximum 255 characters for all
- Non-Indexable Text type
  Two type-written pages of information
  Must be last field on form
- First field is the primary key

*** [[https://diroccovision.com/Coleco/adam/Library/Coleco/RecipeFiler/RecipeFiler%207814%20(R).jpg][Recipe Filer]]

- Adaptation of SmartFiler for storing recipes
- Shopping list built up from selected recipes
- Comes with 30+ example recipes

*** [[https://diroccovision.com/Coleco/adam/Library/Coleco/Smart%20Letters/SmartLnF%207805%20(R).jpg][Smart Letters and Forms]]

- Extends SmartWriter to add form letters
- Select a template; fill out the form.
- Print the result
- Samples for each template

*** [[https://diroccovision.com/Coleco/adam/Library/Coleco/Address%20Book/Address%20Book%207815%20(R).jpg][Address Book Filer and AutoDialer]]

- Address book based on SmartFiler
- Mailing List functionality
- Can use Auto Dialer to dial numbers

** Educational Software

*** [[https://diroccovision.com/Coleco/adam/Library/Coleco/Flashcard%20Maker/Flashcard%20Maker%207662%20(R).jpg][Electronic Flashcard Maker]]

- Quickly make flash cards for school
- 30 decks, with 200 cards each deck on one data pack
- Flash Facts expansion packs
  Vocabulator (Vocabulary Builder)
  American History
  Trivia

*** ExperType

- Touch Typing Tutor
- Adapts to user

** Comparing Games against Super Games

*** Buck Rogers: Planet of Zoom

- More levels
- Redesigned enemies
*** Donkey Kong

- All the levels of the arcade

*** Donkey Kong Jr.

- All the levels of the arcade version
- Prototype with additional Pie Factory level

*** Zaxxon

- All the levels of the arcade version

** ColecoVision Games

- Congo Bongo
- Cosmic Avenger
- Dig Dug
- DragonFire
- Frenzy
- Gyruss
- Jungle Hunt
- Pepper II
- Pitstop
- Popeye
- Roc'n'Rope
- Smurf Rescue
- Space Fury
- Space Panic
- Star Wars

  others.
  
** CP/M and TDOS

*** Booting

- Booted like any other Adam program
- Takes over system
- Approximately 56K TPA

*** Virtual Screen

- Uses VDP Graphics II mode
- 32 columns visible
- 80 column window, scrolls with cursor

*** Even from DDP

- Formatting a DDP for CP/M
- Sysgen a DDP
- You get 256K of space, but...
- Gosh, is it slow. :)

** FujiNet

*** Virtual Disk

- Load software from Internet or local SD card storage
- Write works too
- Supports DDP
- Supports DSK
- Supports ROM (up to 32K non-bank-switched)
- Can copy disk images to/from local/remote sources
- Can create new DSK and DDP images

*** Virtual Printer

- Can print from any ADAM Program
- Outputs using Prestige Elite typeface
- PDF file format
- Send it to any modern printer!

*** Network Adapter

- Talk to modern web endpoints
- Multi-player games
- File transfer over modern protocols


* III. Programming

** Overview

- Z80 at 3.58MHz
- TMS99x8A VDP with 16K of VRAM
- Can treat as ColecoVision or Adam
- Adam boots block 0 at C800H
  
- Can use OS7, SmartWriter, or EOS
  by switching in apropos MIOC bank

- Can develop natively or cross

** MIOC Memory maps

- MIOC splits 64K address space in half

| Mode | Lower                   | Upper             |
|------+-------------------------+-------------------|
|    0 | SmartWriter and EOS     | 32K Intrinsic RAM |
|    1 | 32K Intrinsic RAM       | 32K Intrinsic RAM |
|    2 | 32K Expansion RAM       | 32K Intrinsic RAM |
|    3 | OS7 + 24K Intrinsic RAM | 32K Intrinsic RAM |
|    4 | SmartWriter and EOS     | Expansion ROM     |
|    5 | 32K Intrinsic RAM       | Expansion ROM     |
|    6 | 32K Expansion ROM       | Expansion ROM     |
|    7 | OS7 + 24K Intrinsic RAM | Expansion ROM     |
|    8 | SmartWriter and EOS     | Expansion RAM     |
|    9 | 32K Intrinsic RAM       | Expansion RAM     |
|   10 | 32K Expansion RAM       | Expansion RAM     |
|   11 | OS7 + 24K Intrinsic RAM | Expansion RAM     |
|   12 | SmartWriter and EOS     | Cartridge ROM     |
|   13 | 32K Intrinsic RAM       | Cartridge ROM     |
|   14 | 32K Expansion RAM       | Cartridge ROM     |
|   15 | OS7 + 24K Intrinsic RAM | Cartrifge ROM     |

- Port $42 can select other Expansion RAM banks
  on systems with an addressor card

- Super Games use mode 3 for 52K of usable memory
  and access to OS7 routines

- COLECO applications often switch into SmartWriter
  to use text display routines
  
** Hellorld in C

*** Building Z88DK

#+begin_src sh

  # Instructions for Ubuntu 
  git clone --recursive https://github.com/z88dk/z88dk.git
  sudo apt install build-essential bison flex libxml2-dev subversion zlib1g-dev m4 ragel re2c dos2unix texinfo texi2html gdb curl perl cpanminus ccache libboost-all-dev libmodern-perl-perl libyaml-perl liblocal-lib-perl libcapture-tiny-perl libpath-tiny-perl libtext-table-perl libdata-hexdump-perl libregexp-common-perl libclone-perl libfile-slurp-perl pkg-config
  cpanm --local-lib=~/perl5 App::Prove CPU::Z80::Assembler Data::Dump Data::HexDump File::Path List::Uniq Modern::Perl Object::Tiny::RW Regexp::Common Test::Harness Text::Diff Text::Table YAML::Tiny
  eval $(perl -I ~/perl5/lib/perl5/ -Mlocal::lib)

  cd z88dk
  export BUILD_SDCC=1
  export BUILD_SDCC_HTTP=1
  chmod 777 build.sh
  ./build.sh
  
  . ./set_environment.sh

#+end_src

*** Building eoslib

- C bindings for the EOS
  
#+begin_src sh

  # instructions for ubuntu
  git clone https://github.com/tschak909/eoslib.git
  cd eoslib
  make
  cp src/eos.h ../z88dk/include/
  cp eos.lib ../z88dk/lib/clibs/

#+end_src

*** Building smartkeyslib

- Adds routines to draw SmartKeys

#+begin_src sh

  # instructions for ubuntu
  git clone https://github.com/tschak909/smartkeyslib.git
  cd smartkeyslib
  make
  cp src/smartkeys.h ../z88dk/include/
  cp smartkeys.lib ../z88dk/lib/clibs/

#+end_src

*** Building os7lib

- C bindings for OS7

#+begin_src sh

  git clone https://github.com/tschak909/os7lib.git
  cd os7lib
  make
  cp src/os7.h ../z88dk/include/
  cp os7.lib ../z88dk/lib/clibs/

#+end_src

*** Writing hellorld

#+begin_src C :includes <eos.h>

  #include <eos.h>

  unsigned char hellorld[768]="HELLORLD!";

  void main(void)
  {
    eos_load_ascii_in_vdp(); // load ascii patterns
    eos_write_vram(sizeof(hellorld),0x1800,hellorld); // put message in nametable
    while(1); // sit and spin.
  }

#+end_src

*** Building hellorld

#+begin_src sh

  zcc +coleco -subtype=adam -create-app -ohello.ddp hello.c -leos

#+end_src

** Hellorld in ASM

*** Writing hellorld

#+begin_src asm

EosStart        EQU     0fc30h  ;EOSStart: reset EOS
ConsDisp        EQU     0fc33h  ;ConsoleDisplay: A=character to display (raw output)
ConsInit        EQU     0fc36h  ;ConsoleInitialize: D=top E=left B=width C=height HL=start
ConsOut         EQU     0fc39h  ;ConsOut: A=character to display, with escape characters
ReadKeyboard    EQU     0fc6ch  ;ReadKeyboard: Returns A=key
GotoWP          EQU     0fce7h  ;GotoWP: Starts SmartWRITER
PutAscii        EQU     0fd17h  ;PutASCII: Fills out characters 0x20 to 0x7e
WriteReg        EQU     0fd20h  ;WriteVDPRegister: B=reg, C=value
FillVRam        EQU     0fd26h  ;FillVRam: HL=start, A=character, DE=length
WriteVRam       EQU     0fd1ah  ;WriteVRam: HL=ram address, BC=length, DE=vram address
ReadVRam        EQU     0fd1dh  ;ReadVRam: HL=ram address, BC=length, DE=vram address
InitTable       EQU     0fd29h  ;InitializeVDPTable: A=table #, HL=location
LoadAscii       EQU     0fd38h  ;LoadASCII: HL=first character, BC=count of characters, DE=vram destination
Read1Block      EQU     0fcf3h  ;Actually ReadBlock Input: A=device, HL=memory, BCDE=block
Write1Block     EQU     0fcf6h  ;Actually WriteBlock Output: A=device, HL=memory, BCDE=block
CurrentDev      EQU     0fd6fh  ;Current device ID
DiskA           EQU     04h
DiskB           EQU     05h
TapeA           EQU     08h
TapeB           EQU     18h

NameTable	EQU	2
PatternTable	EQU	3
ColorTable	EQU	4

DefPatternTable EQU     0h
DefNameTable    EQU     1800h
DefSprAttrTable EQU     1b00h
DefColorTable   EQU     2000h
DefSprPatTable  EQU     3800h

NUM_BLOCKS	EQU	1	; # of blocks to load
	
	;; Hello world

	ORG	$0100	; At very top of RAM

	;; First fill out the vectors

START:
	;; Set mode M2

	LD	B,0		; M2
	XOR	C		; To zero
	CALL	WriteReg	; Write VDP register

	;; Set Mode M1

	LD	B,1		; M1
	LD	C,0C0H		; Mode 1, no interrupts
	CALL	WriteReg	; Write VDP register
	
	;; Set border
	
	LD	B,7		; border
	LD	C,4		; Dark Blue
	CALL	WriteReg	; Write VDP register

	;; Clear out VRAM

	LD	HL,$0000	; top of VRAM
	LD	DE,$4000	; All of it
	LD	A,$00		; Zero it out
	CALL	FillVRam	; call VRAM
	
	;; Set table locations
	
	LD	A,PatternTable
	LD	HL,DefPatternTable
	CALL	InitTable

	LD	A,NameTable
	LD	HL,DefNameTable
	CALL	InitTable

	LD	A,ColorTable
	LD	HL,DefColorTable
	CALL	InitTable

	;;  Set blue on white for all patterns
	
	LD	HL,DefColorTable ; Color table
	LD	DE,32		 ; Mode 1 color table is 32 entries long
	LD	A,0xF4		 ; F = White, 4 = dark blue
	CALL	FillVRam	 ; Call fill vram

	;; Put HELLORLD on screen via WriteVram
	
	CALL	LoadAscii	; Put ASCII TABLE into VDP
	LD	HL,HELLORLD	; ptr to HELLORLD screen in HL
	LD	BC,9		; 9 bytes long
	LD	DE,DefNameTable	; Put into nametable in VRAM
	CALL	WriteVRam	; Write it to VRAM

LOOP:	JP	LOOP

HELLORLD:	
	DEFM	"HELLORLD!"

;;; ------------------------------------------------------------------

	SECTION     BOOTSTRAP

	ORG     $C800		; Adam loads block 0 here.
	
Boot:
	LD      A,B
	LD      (CurrentDev),A

start_loading:
	LD      A,@00000001     ; 64k of intrinsic RAM everywhere
	OUT     ($7f),A	    	; and write to MIOC port

	;; Each block is 1k in size
	
	LD      B,NUM_BLOCKS	; # of blocks to load
	LD      HL,$0100	; put at top of memory
	LD      DE,1           	; Block number

load_loop:
	PUSH    BC
	PUSH    DE
	PUSH    HL
	LD      A,(CurrentDev)
	LD      BC,0
	CALL    Read1Block
	POP     HL
	LD      A,H
	ADD     4		; *= $0400 (1024)
	LD      H,A
	POP     DE
	INC     DE
	POP     BC
	DJNZ    load_loop

load_done:	
	LD      A,(CurrentDev)
	LD      B,A
	JP	START

;;; ------------------------------------------------------------------

#+end_src

*** Building hellorld

- Build binary with z88dk-z80asm
- Package binary with bootstrap with z88dk-appmake
  into DDP image
    
#+begin_src sh

  # -b means absolute binary
  z88dk-z80asm -b adam.asm

  # -b means input binary, -zorg means don't apply org address.
  z88dk-appmake +adam -zorg -b adam.bin

#+end_src

* III. References

Information:
- http://www.diroccovision.com/
- http://colecoadam.net/
- http://www.adamemut.byethost4.com/
  
Software Archive:
- http://www.adamarchive.org/

Vendors:
- http://www.lundyelectronics.com/
- http://ann.hollowdreams.com/adamsupplies.html
- http://coleco.freeservers.com/
- https://thebrewingacademy.com/
- http://fujinet.online/
- [[https://8bitmilligames.com/store/coleco-adam.html][https://8bitmilligames.com/store/coleco-adam.html]]
- https://merrickpc.com/coleco-adam/

Technical Manuals:
- https://archive.org/details/coleco-adam-technical-reference-manual
- http://www.adamcon.org/eosprogman.html

TMS 9918A Data book:
- https://archive.org/details/bitsavers_tiTMS9900T_5911832/

Canonical ROM Listings:
- https://archive.org/details/coleco-adam-technical-manual-eos6-os7/

Programming:
- http://www.z88dk.org/
- https://www.github.com/tschak909/os7lib
- https://www.github.com/tschak909/eoslib
- https://www.github.com/tschak909/smartkeyslib
